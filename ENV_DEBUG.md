# –û—Ç–ª–∞–¥–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –∏–∑ .env

## –ü—Ä–æ–±–ª–µ–º–∞
–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–∑ `.env` –Ω–µ —á–∏—Ç–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ: —Ü–µ–Ω—ã –ø–æ–¥–ø–∏—Å–æ–∫ –∏ UUID —Å–∫–≤–∞–¥–æ–≤ –±–µ—Ä—É—Ç—Å—è –∏–∑ –¥–µ—Ñ–æ–ª—Ç–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –≤–º–µ—Å—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–π –∏–∑ `.env`.

## –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ

### 1. –£–ª—É—á—à–µ–Ω –ø–∞—Ä—Å–∏–Ω–≥ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

**–§–∞–π–ª: `src/config.py`**

- –î–æ–±–∞–≤–ª–µ–Ω–æ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ (Settings) –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- –£–ª—É—á—à–µ–Ω –≤–∞–ª–∏–¥–∞—Ç–æ—Ä `parse_internal_squads` - —Ç–µ–ø–µ—Ä—å –≤—Å–µ–≥–¥–∞ —á–∏—Ç–∞–µ—Ç –Ω–∞–ø—Ä—è–º—É—é –∏–∑ `os.getenv()`
- –î–æ–±–∞–≤–ª–µ–Ω–æ –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫:
  - –¶–µ–Ω—ã –ø–æ–¥–ø–∏—Å–æ–∫ (Stars)
  - UUID —Å–∫–≤–∞–¥–æ–≤ (external –∏ internal)
  - –°–ø–∏—Å–æ–∫ –∞–¥–º–∏–Ω–æ–≤

### 2. –î–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ API –≤—ã–∑–æ–≤–æ–≤

**–§–∞–π–ª: `src/services/api_client.py`**

- –í `create_user()` –¥–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ payload –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π
- –í `update_user()` –¥–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ payload –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π
- –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤–∏–¥–µ—Ç—å, –∫–∞–∫–∏–µ –∏–º–µ–Ω–Ω–æ –¥–∞–Ω–Ω—ã–µ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –≤ Remnawave API

### 3. –°–æ–∑–¥–∞–Ω —Ç–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç

**–§–∞–π–ª: `test_settings.py`**

–°–∫—Ä–∏–ø—Ç –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ —á—Ç–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫ –∏–∑ `.env`:
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ü–µ–Ω—ã –ø–æ–¥–ø–∏—Å–æ–∫
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç UUID —Å–∫–≤–∞–¥–æ–≤
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –∞–¥–º–∏–Ω–æ–≤
- –°—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ Settings —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è

## –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

### 1. –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–¥

```bash
cd /opt/remnabuy
git pull
```

### 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å .env —Ñ–∞–π–ª

```bash
cat .env | grep -E "(SUBSCRIPTION_STARS|DEFAULT_.*_SQUAD)"
```

**–í–∞–∂–Ω–æ**: –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∑–∞–ø–æ–ª–Ω–µ–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ:

```bash
# –¶–µ–Ω—ã –ø–æ–¥–ø–∏—Å–æ–∫ (–≤ Stars)
SUBSCRIPTION_STARS_1MONTH=150
SUBSCRIPTION_STARS_3MONTHS=400
SUBSCRIPTION_STARS_6MONTHS=700
SUBSCRIPTION_STARS_12MONTHS=1200

# –°–∫–≤–∞–¥—ã –¥–ª—è –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
DEFAULT_EXTERNAL_SQUAD_UUID=–≤–∞—à-–≤–Ω–µ—à–Ω–∏–π-uuid
DEFAULT_INTERNAL_SQUADS=–≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π-uuid-1,–≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π-uuid-2
```

**–í–ê–ñ–ù–û –¥–ª—è `DEFAULT_INTERNAL_SQUADS`**:
- –ó–Ω–∞—á–µ–Ω–∏—è —Ä–∞–∑–¥–µ–ª—è—é—Ç—Å—è **–∑–∞–ø—è—Ç–æ–π –ë–ï–ó –ø—Ä–æ–±–µ–ª–æ–≤** –∏–ª–∏ **–∑–∞–ø—è—Ç–æ–π –° –ø—Ä–æ–±–µ–ª–æ–º –ø–æ—Å–ª–µ**
- –ü—Ä–∞–≤–∏–ª—å–Ω–æ: `uuid1,uuid2,uuid3` –∏–ª–∏ `uuid1, uuid2, uuid3`
- –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ: `uuid1 , uuid2` (–ø—Ä–æ–±–µ–ª –ø–µ—Ä–µ–¥ –∑–∞–ø—è—Ç–æ–π)

### 3. –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç –ª–æ–∫–∞–ª—å–Ω–æ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–ù–∞ —Å–µ—Ä–≤–µ—Ä–µ –º–æ–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç:

```bash
cd /opt/remnabuy
python3 test_settings.py
```

–û–Ω –ø–æ–∫–∞–∂–µ—Ç, –∫–∞–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è —á–∏—Ç–∞—é—Ç—Å—è –∏–∑ `.env`.

### 4. –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç

```bash
docker compose build --no-cache bot
docker compose up -d
docker compose logs -f bot
```

### 5. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏

–í –ª–æ–≥–∞—Ö –±–æ—Ç–∞ —Ç–µ–ø–µ—Ä—å –±—É–¥–µ—Ç –±–ª–æ–∫ —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏:

```
=============================================================
SETTINGS LOADED
=============================================================
Subscription prices (Stars):
  1 month:  150 stars (env: 150)
  3 months: 400 stars (env: 400)
  6 months: 700 stars (env: 700)
  12 months: 1200 stars (env: 1200)

Squads configuration:
  External squad: –≤–∞—à-uuid (env: –≤–∞—à-uuid)
  Internal squads: ['uuid1', 'uuid2'] (env: uuid1,uuid2)
  Parsed internal squads count: 2

Admins: [12345678] (env: 12345678)
=============================================================
```

### 6. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

–ö–æ–≥–¥–∞ –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è –ø—Ä–æ–±–Ω–∞—è –ø–æ–¥–ø–∏—Å–∫–∞ –∏–ª–∏ –æ–ø–ª–∞—á–∏–≤–∞–µ—Ç—Å—è –ø–æ–¥–ø–∏—Å–∫–∞, –≤ –ª–æ–≥–∞—Ö –±—É–¥–µ—Ç:

```
üîµ API: Creating user with payload: {
  'username': 'testuser',
  'expireAt': '2026-01-10T12:00:00Z',
  'telegramId': 12345678,
  'description': 'trial',
  'externalSquadUuid': '–≤–∞—à-–≤–Ω–µ—à–Ω–∏–π-uuid',
  'activeInternalSquads': ['–≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π-uuid-1', '–≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π-uuid-2']
}
```

–ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è:

```
üîµ API: Updating user abc-123 with payload: {
  'uuid': 'abc-123',
  'externalSquadUuid': '–≤–∞—à-–≤–Ω–µ—à–Ω–∏–π-uuid',
  'activeInternalSquads': ['–≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π-uuid-1', '–≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π-uuid-2']
}
```

## –ß—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ –ø–∞–Ω–µ–ª–∏ Remnawave

–ü–æ—Å–ª–µ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –ø—Ä–æ–±–Ω–æ–π –ø–æ–¥–ø–∏—Å–∫–∏ –∏–ª–∏ –æ–ø–ª–∞—Ç—ã:

1. –û—Ç–∫—Ä–æ–π—Ç–µ –ø–∞–Ω–µ–ª—å Remnawave
2. –ù–∞–π–¥–∏—Ç–µ —Å–æ–∑–¥–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ:
   - **External Squad** - –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤–∞—à UUID
   - **Internal Squads** - –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –≤–∞—à–∏ UUID (–º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ)

## –ï—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤—Å—ë —Ä–∞–≤–Ω–æ –Ω–µ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ü—Ä–æ–±–ª–µ–º–∞ —Å .env

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –ø—Ä–∞–≤–∏–ª—å–Ω–æ —á–∏—Ç–∞–µ—Ç `.env`:

```bash
docker compose config | grep -E "(SUBSCRIPTION_STARS|DEFAULT_.*_SQUAD)"
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ö–µ—à –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å –ø–æ–ª–Ω–æ–π –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–æ–π:

```bash
docker compose down
docker compose up -d
docker compose logs -f bot
```

### –í–∞—Ä–∏–∞–Ω—Ç 3: API Remnawave –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç —Å–∫–≤–∞–¥—ã –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏

–ï—Å–ª–∏ –≤ –ª–æ–≥–∞—Ö –≤–∏–¥–Ω–æ, —á—Ç–æ payload —Å–æ–¥–µ—Ä–∂–∏—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ UUID, –Ω–æ –≤ –ø–∞–Ω–µ–ª–∏ Remnawave –æ–Ω–∏ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–µ—Ä—Å–∏—é API Remnawave - –≤–æ–∑–º–æ–∂–Ω–æ, –æ–Ω–∞ –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∫—É —Å–∫–≤–∞–¥–æ–≤ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
2. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–∫–≤–∞–¥—ã –≤—Ä—É—á–Ω—É—é —á–µ—Ä–µ–∑ –ø–∞–Ω–µ–ª—å –¥–ª—è –æ–¥–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
3. –ï—Å–ª–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç - –∑–Ω–∞—á–∏—Ç API —Ç—Ä–µ–±—É–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏–ª–∏ –¥—Ä—É–≥–æ–π endpoint

–í –∫–æ–¥–µ —É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –∑–∞—â–∏—Ç–∞: –ø–æ—Å–ª–µ `create_user` –≤—Å–µ–≥–¥–∞ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è `update_user` –¥–ª—è –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —Å–∫–≤–∞–¥–æ–≤.

## –û—á–∏—Å—Ç–∫–∞ –ø–æ—Å–ª–µ –æ—Ç–ª–∞–¥–∫–∏

–ö–æ–≥–¥–∞ –≤—Å—ë –∑–∞—Ä–∞–±–æ—Ç–∞–µ—Ç, –º–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç:

```bash
rm test_settings.py
rm ENV_DEBUG.md
```

