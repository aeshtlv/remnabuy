# Руководство пользователя

## Описание

Этот бот предназначен для покупки и управления подписками Remnawave. Пользователи могут регистрироваться, просматривать свою подписку, использовать промокоды и участвовать в реферальной программе.

## Возможности для пользователей

### Регистрация и выбор языка
- При первом запуске бота (`/start`) пользователь автоматически регистрируется
- Поддержка русского и английского языков
- Смена языка доступна в меню

### Просмотр подписки
- Статус подписки (активна, истекла, отключена)
- Дата окончания подписки
- Использованный трафик
- Ссылка на конфигурацию

### Пробная подписка
- Одна пробная подписка на пользователя
- Активация вручную по кнопке (требуется подтверждение администратора)

### Промокоды
- Ввод промокода текстовым сообщением
- Промокоды могут давать скидку или бонусные дни
- Валидация промокодов (срок действия, лимит использований)

### Реферальная программа
- Реферальная ссылка для приглашения друзей
- Статистика приглашенных друзей
- Бонусные дни за каждого приглашенного

### Покупка подписки
- Базовая структура для оплаты через Telegram Stars (в разработке)
- После оплаты пользователь получает ссылку на конфиг

## Админ-панель

Админ-панель остается полностью функциональной. Все админские команды доступны только пользователям из списка `ADMINS` в `.env` файле.

## Настройка базы данных

База данных SQLite (`bot_data.db`) создается автоматически при первом запуске бота. В ней хранится:
- Информация о пользователях бота
- Промокоды
- Реферальные связи
- История платежей

## Создание промокодов (для админов)

Для создания промокодов можно использовать SQLite напрямую или добавить админскую команду:

```sql
INSERT INTO promo_codes (code, discount_percent, bonus_days, max_uses, expires_at)
VALUES ('PROMO2025', 10, 7, 100, '2025-12-31T23:59:59');
```

Параметры:
- `code` - код промокода (обязательно)
- `discount_percent` - процент скидки (NULL если нет скидки)
- `bonus_days` - бонусные дни (NULL если нет бонуса)
- `max_uses` - максимальное количество использований (NULL = безлимит)
- `expires_at` - дата истечения (NULL = без срока)

## Переменные окружения

Все существующие переменные окружения остаются без изменений:
- `BOT_TOKEN` - токен Telegram бота
- `API_BASE_URL` - URL API Remnawave
- `API_TOKEN` - токен API Remnawave
- `ADMINS` - список ID администраторов (через запятую)
- `DEFAULT_LOCALE` - язык по умолчанию (`ru` или `en`)
- `LOG_LEVEL` - уровень логирования

